<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style2.css" />
    <style></style>
    <title>迷因</title>
  </head>
  <body>
    <div class="container">
      <div class="title">
        <h1>迷因的幽默與冒犯</h1>
        <p>
          <br />此問卷希望您根據個人主觀判斷以下迷因的<b>好笑（幽默）程度</b>
          和<b>冒犯程度</b>。「冒犯」的定義包含對任一個體沒有禮貌、得罪或激怒該個體，只要讓人覺得被攻擊都算。<b>被冒犯者可以是社會上任一生命體、族群或個人，只要你感受到有就可以。</b>此問卷希望大家發揮同理心，感受一下個體被冒犯的程度，<b>被冒犯者不需要是你自己</b>，可以是梗圖想針對的目標，或是不小心被波及到的任何生命。<br />
          <br />
          兩者評分標準皆為 0 - 5，0 為完全不（好笑/冒犯），5
          為超級（好笑/冒犯）。<br />
        </p>
        <p>
          以下面這張迷因為例，由於自己曾目<s>（經）</s>睹<s>（歷）</s>過類似情況，覺得有點貼切，滿好笑的，幽默程度我給4分。然後因為有人被看似很兇的語氣不禮貌地要求站起來，加上可能參雜了一點對黑人形象的刻板印象，所以冒犯程度我覺得大概3分。評分方式就是這麼主觀～
          <br />
          <img
            class="sample-image"
            name="sample-image"
            src="https://raw.githubusercontent.com/Chilinhung/meme_questionnaire/main/images/random_meme_2022_CfGEHa_vKqn.jpg"
            alt="sample image"
            style="
              width: 60%;
              margin: auto;
              display: flex;
              border: 2px solid #3f3e3e;
            "
          />
        </p>
        <br />

        <form id="questionnaireForm">
          <p style="margin: auto; display: flex">
            選擇問卷集後就可以開始填寫囉～！
          </p>
          <label for="set_num">問卷集：</label>
          <select id="set_num" name="set_num"></select>
        </form>
      </div>
      <form id="survey-form">
        <div id="questions" class="questions">
          <script>
            document.addEventListener("DOMContentLoaded", function () {
              const selectElement = document.getElementById("set_num");
              const questionsContainer = document.getElementById("questions");
              const baseURL =
                "https://raw.githubusercontent.com/Chilinhung/meme_questionnaire/main";

              fetch(`${baseURL}/question_set.json`)
                .then((response) => response.json())
                .then((questionSets) => {
                  populateOptions(questionSets, selectElement);
                  selectElement.addEventListener("change", function () {
                    updateQuestions(questionSets, selectElement.value);
                  });
                  if (selectElement.options.length > 0) {
                    selectElement.value = selectElement.options[0].value;
                    selectElement.dispatchEvent(new Event("change"));
                  }
                })
                .catch((error) => {
                  console.error("Failed to fetch image set:", error);
                });

              function populateOptions(questionSets, selectElement) {
                Object.keys(questionSets).forEach((key) => {
                  const option = document.createElement("option");
                  option.value = key;
                  option.textContent = key.replace("set_", "Set ");
                  selectElement.appendChild(option);
                });
              }

              function updateQuestions(questionSets, selectedSet) {
                const setImageNames = questionSets[selectedSet];
                questionsContainer.innerHTML = "";
                setImageNames.forEach((imageName, index) => {
                  const imageUrl = `${baseURL}/images/${selectedSet}/${imageName}`;
                  questionsContainer.innerHTML += createQuestionHTML(
                    index,
                    imageUrl,
                    selectedSet
                  );
                });
              }

              function createQuestionHTML(index, imageUrl, selectedSet) {
                return `
                        <div class="questions">
                            <br />
                            <h3>Question ${index + 1}</h3> 
                            <div class= "content">
                                <img class='question-image' src='${imageUrl}' alt="Meme image for question ${index + 1}" style="max-width: 95%; height: auto; border: 3px solid #268484">
                                <div class="question-text">
                                    <p>這個迷因的幽默程度你給幾分？</p>
                                    <div class="slider-container">
                                        <input type="range" class="question-input" name="questionInput" data-question-id="${selectedSet}_q${index + 1}" data-aspect="humor" min="0" max="5" value="0" max-width=: 100%;height: 26px;> 
                                        <div class="slider-marks">
                                            <span>0</span>
                                            <span>1</span>
                                            <span>2</span>
                                            <span>3</span>
                                            <span>4</span>
                                            <span>5</span>
                                        </div>
                                    </div>
                                    <p>這個迷因的冒犯程度你給幾分？</p>
                                    <div class="slider-container">
                                        <input type="range" class="question-input" name="questionInput" data-question-id="${selectedSet}_q${index + 1}" data-aspect="offensive" min="0" max="5" value="0">
                                        <div class="slider-marks">
                                            <span>0</span>
                                            <span>1</span>
                                            <span>2</span>
                                            <span>3</span>
                                            <span>4</span>
                                            <span>5</span>
                                        </div>
                                    </div>
                                </div>
                                <br /><br /><br /><br />
                            </div>
                        </div>
                    `;
              }

              function attachRangeInputEvents() {
                document
                  .querySelectorAll('.slider-container input[type="range"]')
                  .forEach((input) => {
                    input.addEventListener("input", function () {
                      console.log("Slider value: ", this.value);
                    });
                  });
              }
            });
          </script>
        </div>

        <div class="personal_info">
          <br />
          <p>
            請問你的性別是？
            <input type="radio" id="male" name="gender" value="male" />
            <label for="male">生理男</label>
            <input type="radio" id="female" name="gender" value="female" />
            <label for="female">生理女</label>
          </p>
          <br />
          <p>
            請問你的年齡區間落在？
            <select name="age">
              <option value="15-20">15-20</option>
              <option value="21-25">21-25</option>
              <option value="26-30">26-30</option>
              <option value="31-35">31-35</option>
              <option value="36-40">36-40</option>
              <option value="41-45">41-45</option>
              <option value="46-50">46-50</option>
              <option value="51-55">51-55</option>
              <option value="56-60">56-60</option>
              <option value="61-65">61-65</option>
              <option value="66-70">66-70</option>
              <option value="71+">71以上</option>
            </select>
          </p>
          <br />
          <p>
            <label for="userInput">歡迎留下您的大名、小名或個性簽名：</label>
            <input type="text" id="userInput" name="userInput" />
          </p>
        </div>
      </form>
      <br />
      <br />
      <h4>感謝您撥冗填寫</h4>
      <br />
      <div class="submission">
        <button type="button" id="submit_btn">提交問卷</button>
      </div>
    </div>
    <script src="output_result.js"></script>
  </body>
</html>
